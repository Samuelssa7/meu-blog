---
title: "Regress칚o Linear: Rela칞칚o entre Sal치rio e Estudo"
author: "Samuel Andrey"
date: "2025-11-21"
categories: [python, data-science, statistics, plotnine, numpy]
image: "image.jpg"
---

Veja um g치fico linear analisando anos de estudo e faixa salarial. 游늳

---

### 1. Carregamento das Bibliotecas e Dados

Nesta etapa, importamos as bibliotecas necess치rias para manipula칞칚o de arrays (`numpy`), dados (`pandas`) e gr치ficos (`plotnine`). Tamb칠m carregamos os dados de entrada (`X.txt`) e sa칤da (`y.txt`).

```{python}
import numpy as np
import pandas as pd
from plotnine import ggplot, aes, geom_point, geom_abline, ggsave

valores_x = np.loadtxt('X.txt')
valores_y = np.loadtxt('y.txt')
```

---

### 2. C치lculo dos Coeficientes
Aqui preparamos a matriz adicionando uma coluna de "1s" (`para o intercepto`) e aplicamos a f칩rmula da Equa칞칚o Normal para encontrar os melhores valores para theta. Ao final, separamos o intercepto (`a`) e a inclina칞칚o (`b`).

```{python}
X_b = np.c_[np.ones((len(valores_x), 1)), valores_x]
theta_best = np.linalg.inv(X_b.T.dot(X_b)).dot(X_b.T).dot(valores_y)

a = theta_best[0]
b = theta_best[1]
```

---

### 3. Gera칞칚o e Salvamento do Gr치fico
Com os coeficientes calculados, criamos o gr치fico contendo os pontos originais e a reta de regress칚o (`em vermelho`). O comando final salva o resultado como uma imagem.

```{python}
#| warning: false
df = {"x": valores_x, "y": valores_y}

plot = (
  ggplot(pd.DataFrame(df), aes("x", "y"))
  + geom_point()
  + geom_abline(intercept=a, slope=b, color="red")
)

plot.save("grafico.png")
```

---

### C칩digo Completo e Resultado
Abaixo, o c칩digo completo para execu칞칚o e a imagem gerada:

```{python}
#| warning: false
import numpy as np
import pandas as pd
from plotnine import ggplot, aes, geom_point, geom_abline, ggsave

valores_x = np.loadtxt('X.txt')
valores_y = np.loadtxt('y.txt')

X_b = np.c_[np.ones((len(valores_x), 1)), valores_x]
theta_best = np.linalg.inv(X_b.T.dot(X_b)).dot(X_b.T).dot(valores_y)

a = theta_best[0]
b = theta_best[1]

df = {"x": valores_x, "y": valores_y}

plot = (
  ggplot(pd.DataFrame(df), aes("x", "y"))
  + geom_point()
  + geom_abline(intercept=a, slope=b, color="red")
)

plot.save("grafico.png")
```

![Gr치fico de Regress칚o Linear](grafico.png){width=100%}
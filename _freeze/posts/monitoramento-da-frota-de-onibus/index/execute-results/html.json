{
  "hash": "6fa35ea085eae5cce81d40e60484e83a",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Monitoramento da Frota de Ônibus\"\nautor: \"Samuel\"\ndate: \"2025-11-19\"\ncategories: [news, code, analysis]\nimage: \"image_bus.jpg\"\n---\n\nDescubra a rota e localização de um ônibus.\n\n::: {#bf2464ad .cell execution_count=1}\n``` {.python .cell-code}\nimport os\nimport requests\nfrom folium import Map, Marker, Icon\nfrom dotenv import load_dotenv\n\nload_dotenv(\".env\")\n\ns = requests.Session()\nres = s.post(\n    f\"http://api.olhovivo.sptrans.com.br/v2.1/Login/Autenticar?token={os.getenv('SPTRANS_TOKEN')}\"\n)\n\npos = s.get(\n    \"http://api.olhovivo.sptrans.com.br/v2.1//Posicao/Linha?codigoLinha=2304\"\n)\nposicao_atual = pos.json()\npy_bus = posicao_atual[\"vs\"][0][\"py\"]\npx_bus = posicao_atual[\"vs\"][0][\"px\"]\n\nres = s.get(\n    \"http://api.olhovivo.sptrans.com.br/v2.1/Parada/BuscarParadasPorLinha?codigoLinha=2304\"\n)\nparadas = res.json()\n\nm = Map(location=[py_bus, px_bus], zoom_start=14)\nfor i in paradas:\n    Marker(location=[i[\"py\"], i[\"px\"]], popup=\"PARADA \" + i[\"np\"]).add_to(m)\nMarker(location=[py_bus, px_bus], popup=\"ÔNIBUS\", icon=Icon(color='green', icon='bus', prefix='fa')).add_to(m)\n\nm\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div style=\"width:100%;\"><div style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"><span style=\"color:#565656\">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe srcdoc=\"&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    \n    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://code.jquery.com/jquery-3.7.1.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;&gt;&lt;/script&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/&gt;\n    \n            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,\n                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; /&gt;\n            &lt;style&gt;\n                #map_facd0217358ce6e7035bbfa11ac62fa7 {\n                    position: relative;\n                    width: 100.0%;\n                    height: 100.0%;\n                    left: 0.0%;\n                    top: 0.0%;\n                }\n                .leaflet-container { font-size: 1rem; }\n            &lt;/style&gt;\n\n            &lt;style&gt;html, body {\n                width: 100%;\n                height: 100%;\n                margin: 0;\n                padding: 0;\n            }\n            &lt;/style&gt;\n\n            &lt;style&gt;#map {\n                position:absolute;\n                top:0;\n                bottom:0;\n                right:0;\n                left:0;\n                }\n            &lt;/style&gt;\n\n            &lt;script&gt;\n                L_NO_TOUCH = false;\n                L_DISABLE_3D = false;\n            &lt;/script&gt;\n\n        \n&lt;/head&gt;\n&lt;body&gt;\n    \n    \n            &lt;div class=&quot;folium-map&quot; id=&quot;map_facd0217358ce6e7035bbfa11ac62fa7&quot; &gt;&lt;/div&gt;\n        \n&lt;/body&gt;\n&lt;script&gt;\n    \n    \n            var map_facd0217358ce6e7035bbfa11ac62fa7 = L.map(\n                &quot;map_facd0217358ce6e7035bbfa11ac62fa7&quot;,\n                {\n                    center: [-23.48940525, -46.69845125],\n                    crs: L.CRS.EPSG3857,\n                    ...{\n  &quot;zoom&quot;: 14,\n  &quot;zoomControl&quot;: true,\n  &quot;preferCanvas&quot;: false,\n}\n\n                }\n            );\n\n            \n\n        \n    \n            var tile_layer_51765fbcde17d272ae3533e112d2c54c = L.tileLayer(\n                &quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,\n                {\n  &quot;minZoom&quot;: 0,\n  &quot;maxZoom&quot;: 19,\n  &quot;maxNativeZoom&quot;: 19,\n  &quot;noWrap&quot;: false,\n  &quot;attribution&quot;: &quot;\\u0026copy; \\u003ca href=\\&quot;https://www.openstreetmap.org/copyright\\&quot;\\u003eOpenStreetMap\\u003c/a\\u003e contributors&quot;,\n  &quot;subdomains&quot;: &quot;abc&quot;,\n  &quot;detectRetina&quot;: false,\n  &quot;tms&quot;: false,\n  &quot;opacity&quot;: 1,\n}\n\n            );\n        \n    \n            tile_layer_51765fbcde17d272ae3533e112d2c54c.addTo(map_facd0217358ce6e7035bbfa11ac62fa7);\n        \n    \n            var marker_af50aea7f8538e9a9d06ceaaa6f127e2 = L.marker(\n                [-23.525799, -46.679251],\n                {\n}\n            ).addTo(map_facd0217358ce6e7035bbfa11ac62fa7);\n        \n    \n        var popup_cb4458aaee1d3f518d5e6d5baa7e93cd = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_3ded32cc612ac71a104e8090eb8366f1 = $(`&lt;div id=&quot;html_3ded32cc612ac71a104e8090eb8366f1&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA PARADA PALMEIRAS B/C&lt;/div&gt;`)[0];\n                popup_cb4458aaee1d3f518d5e6d5baa7e93cd.setContent(html_3ded32cc612ac71a104e8090eb8366f1);\n            \n        \n\n        marker_af50aea7f8538e9a9d06ceaaa6f127e2.bindPopup(popup_cb4458aaee1d3f518d5e6d5baa7e93cd)\n        ;\n\n        \n    \n    \n            var marker_287f89e2b268c5b0dcd8ee22bb314121 = L.marker(\n                [-23.511052, -46.705493],\n                {\n}\n            ).addTo(map_facd0217358ce6e7035bbfa11ac62fa7);\n        \n    \n        var popup_69b2326c9081311b95b76742fbd6d526 = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_4557d32abe542f12598cbb10c9218aa9 = $(`&lt;div id=&quot;html_4557d32abe542f12598cbb10c9218aa9&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA MARGINAL B/C&lt;/div&gt;`)[0];\n                popup_69b2326c9081311b95b76742fbd6d526.setContent(html_4557d32abe542f12598cbb10c9218aa9);\n            \n        \n\n        marker_287f89e2b268c5b0dcd8ee22bb314121.bindPopup(popup_69b2326c9081311b95b76742fbd6d526)\n        ;\n\n        \n    \n    \n            var marker_18f24f83b20f4b17ffc66f1733b0df02 = L.marker(\n                [-23.514036, -46.702259],\n                {\n}\n            ).addTo(map_facd0217358ce6e7035bbfa11ac62fa7);\n        \n    \n        var popup_0a3255f1272530c24481195a73626210 = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_bf91e15e65e5ae57f683f413bb53723c = $(`&lt;div id=&quot;html_bf91e15e65e5ae57f683f413bb53723c&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA JOSE MARIA B/C&lt;/div&gt;`)[0];\n                popup_0a3255f1272530c24481195a73626210.setContent(html_bf91e15e65e5ae57f683f413bb53723c);\n            \n        \n\n        marker_18f24f83b20f4b17ffc66f1733b0df02.bindPopup(popup_0a3255f1272530c24481195a73626210)\n        ;\n\n        \n    \n    \n            var marker_44111a677d7f34c570485942593d7336 = L.marker(\n                [-23.516592, -46.698575],\n                {\n}\n            ).addTo(map_facd0217358ce6e7035bbfa11ac62fa7);\n        \n    \n        var popup_8dd4837fdaea0b6cd25a8f9b5ceed8c6 = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_8a3397d36d638c0c49bd0c74d5932d6d = $(`&lt;div id=&quot;html_8a3397d36d638c0c49bd0c74d5932d6d&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA ZANELLA B/C&lt;/div&gt;`)[0];\n                popup_8dd4837fdaea0b6cd25a8f9b5ceed8c6.setContent(html_8a3397d36d638c0c49bd0c74d5932d6d);\n            \n        \n\n        marker_44111a677d7f34c570485942593d7336.bindPopup(popup_8dd4837fdaea0b6cd25a8f9b5ceed8c6)\n        ;\n\n        \n    \n    \n            var marker_70813385710017cdb1c04257d7436701 = L.marker(\n                [-23.52494, -46.698995],\n                {\n}\n            ).addTo(map_facd0217358ce6e7035bbfa11ac62fa7);\n        \n    \n        var popup_61ddf4a3beacd83b191bf2e2920a5864 = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_d43195c00280768c9f3a963512560e45 = $(`&lt;div id=&quot;html_d43195c00280768c9f3a963512560e45&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA SCIPIAO B/C&lt;/div&gt;`)[0];\n                popup_61ddf4a3beacd83b191bf2e2920a5864.setContent(html_d43195c00280768c9f3a963512560e45);\n            \n        \n\n        marker_70813385710017cdb1c04257d7436701.bindPopup(popup_61ddf4a3beacd83b191bf2e2920a5864)\n        ;\n\n        \n    \n    \n            var marker_b745a39fe89fc27ea2fc5127911fbbc6 = L.marker(\n                [-23.524994, -46.695297],\n                {\n}\n            ).addTo(map_facd0217358ce6e7035bbfa11ac62fa7);\n        \n    \n        var popup_2be6a4bacb8421e62eacdd391893de55 = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_1e57e9b367b846ad58758972ffa5d851 = $(`&lt;div id=&quot;html_1e57e9b367b846ad58758972ffa5d851&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA VESPASIANO B/C&lt;/div&gt;`)[0];\n                popup_2be6a4bacb8421e62eacdd391893de55.setContent(html_1e57e9b367b846ad58758972ffa5d851);\n            \n        \n\n        marker_b745a39fe89fc27ea2fc5127911fbbc6.bindPopup(popup_2be6a4bacb8421e62eacdd391893de55)\n        ;\n\n        \n    \n    \n            var marker_bd771701f3893c7af00f1d0e131020e0 = L.marker(\n                [-23.525029, -46.690074],\n                {\n}\n            ).addTo(map_facd0217358ce6e7035bbfa11ac62fa7);\n        \n    \n        var popup_f4d392af30c34f81985d8b464a01d34a = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_e79f2a3ccb4cb4a5bf48ae9fc97866dc = $(`&lt;div id=&quot;html_e79f2a3ccb4cb4a5bf48ae9fc97866dc&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA CORNELIA&lt;/div&gt;`)[0];\n                popup_f4d392af30c34f81985d8b464a01d34a.setContent(html_e79f2a3ccb4cb4a5bf48ae9fc97866dc);\n            \n        \n\n        marker_bd771701f3893c7af00f1d0e131020e0.bindPopup(popup_f4d392af30c34f81985d8b464a01d34a)\n        ;\n\n        \n    \n    \n            var marker_674b0348c7f06ba240d0eeb36740a251 = L.marker(\n                [-23.52517, -46.683408],\n                {\n}\n            ).addTo(map_facd0217358ce6e7035bbfa11ac62fa7);\n        \n    \n        var popup_6005837b2033b20f870b6bfa40294d7f = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_03f08e8f644e8cf7b4ee78ba6ff33af0 = $(`&lt;div id=&quot;html_03f08e8f644e8cf7b4ee78ba6ff33af0&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA SESC POMPEIA B/C&lt;/div&gt;`)[0];\n                popup_6005837b2033b20f870b6bfa40294d7f.setContent(html_03f08e8f644e8cf7b4ee78ba6ff33af0);\n            \n        \n\n        marker_674b0348c7f06ba240d0eeb36740a251.bindPopup(popup_6005837b2033b20f870b6bfa40294d7f)\n        ;\n\n        \n    \n    \n            var marker_1d16765283958c28165d5072aef3dcb8 = L.marker(\n                [-23.500896, -46.706633],\n                {\n}\n            ).addTo(map_facd0217358ce6e7035bbfa11ac62fa7);\n        \n    \n        var popup_715ee6f2e66690ab9831aa0b7accc7e0 = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_6bbbef3c01ac8ceb240c04580ae352e2 = $(`&lt;div id=&quot;html_6bbbef3c01ac8ceb240c04580ae352e2&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA PAULA FERREIRA B/C&lt;/div&gt;`)[0];\n                popup_715ee6f2e66690ab9831aa0b7accc7e0.setContent(html_6bbbef3c01ac8ceb240c04580ae352e2);\n            \n        \n\n        marker_1d16765283958c28165d5072aef3dcb8.bindPopup(popup_715ee6f2e66690ab9831aa0b7accc7e0)\n        ;\n\n        \n    \n    \n            var marker_4c3235aa6ecad011467dfcd3512f32d3 = L.marker(\n                [-23.50616, -46.706061],\n                {\n}\n            ).addTo(map_facd0217358ce6e7035bbfa11ac62fa7);\n        \n    \n        var popup_5ef78443b789426e2ad30cb6b549fe19 = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_bf4aade4320a49a44516ecd25c14a741 = $(`&lt;div id=&quot;html_bf4aade4320a49a44516ecd25c14a741&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA PIQUERI B/C&lt;/div&gt;`)[0];\n                popup_5ef78443b789426e2ad30cb6b549fe19.setContent(html_bf4aade4320a49a44516ecd25c14a741);\n            \n        \n\n        marker_4c3235aa6ecad011467dfcd3512f32d3.bindPopup(popup_5ef78443b789426e2ad30cb6b549fe19)\n        ;\n\n        \n    \n    \n            var marker_53d11bb90c844f800e572ffed8156f44 = L.marker(\n                [-23.48940525, -46.69845125],\n                {\n}\n            ).addTo(map_facd0217358ce6e7035bbfa11ac62fa7);\n        \n    \n            var icon_bdc172fed1a1d2ea14164eb5e6929c00 = L.AwesomeMarkers.icon(\n                {\n  &quot;markerColor&quot;: &quot;green&quot;,\n  &quot;iconColor&quot;: &quot;white&quot;,\n  &quot;icon&quot;: &quot;bus&quot;,\n  &quot;prefix&quot;: &quot;fa&quot;,\n  &quot;extraClasses&quot;: &quot;fa-rotate-0&quot;,\n}\n            );\n        \n    \n        var popup_661027ca55dec55470e67749c0bf3f15 = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_b316b705eeac25b94fc53cc92b8749c8 = $(`&lt;div id=&quot;html_b316b705eeac25b94fc53cc92b8749c8&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;ÔNIBUS&lt;/div&gt;`)[0];\n                popup_661027ca55dec55470e67749c0bf3f15.setContent(html_b316b705eeac25b94fc53cc92b8749c8);\n            \n        \n\n        marker_53d11bb90c844f800e572ffed8156f44.bindPopup(popup_661027ca55dec55470e67749c0bf3f15)\n        ;\n\n        \n    \n    \n                marker_53d11bb90c844f800e572ffed8156f44.setIcon(icon_bdc172fed1a1d2ea14164eb5e6929c00);\n            \n&lt;/script&gt;\n&lt;/html&gt;\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}